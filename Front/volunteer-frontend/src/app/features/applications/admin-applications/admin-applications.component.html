<div class="page-container">
  <div class="card">
    <h2 class="name-page">Заявки волонтёров</h2>

    <mat-progress-spinner *ngIf="loading" mode="indeterminate" class="spinner"></mat-progress-spinner>

    <table #dataTable class="my-custom-table" *ngIf="!loading && dataSource.length > 0">
      <thead>
        <tr>
          <th>Волонтёр</th>
          <th>Событие</th>
          <th>Мероприятие</th>
          <th>Комментарий</th>
          <th>Дата подачи</th>
          <th>Статус</th>
          <th>Действия</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let app of dataSource | slice: (currentPage - 1) * pageSize : currentPage * pageSize">
          <td>{{app.userLogin}}</td>
          <td>{{app.eventName}}</td>
          <td>{{app.activityName}}</td>
          <td>{{app.comment || '—'}}</td>
          <td>{{app.submissionDate | date:'dd.MM.yyyy HH:mm'}}</td>
          <td>
            <span [ngClass]="{
              'status-approved': app.status === 'APPROVED',
              'status-rejected': app.status === 'REJECTED',
              'status-pending': app.status === 'PENDING'
            }">
              {{app.status | statusTranslate}}
            </span>
          </td>
          <td>
            <button *ngIf="app.status === 'PENDING'" class="action-btn btn-approve" (click)="approve(app.id)">
              <i class="material-icons">check</i> Одобрить
            </button>
            <button *ngIf="app.status === 'PENDING'" class="action-btn btn-reject" (click)="reject(app.id)">
              <i class="material-icons">close</i> Отклонить
            </button>
            <button class="action-btn btn-view" (click)="viewQuestionnaire(app.userId)">
              <i class="material-icons">visibility</i> Анкета
            </button>
            <button class="action-btn btn-delete" (click)="delete(app.id)">
              <i class="material-icons">delete</i> Удалить
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Ручная пагинация -->
    <div class="pagination" *ngIf="!loading && dataSource.length > 0">
      <button class="page-btn" (click)="goToPage(1)" [disabled]="currentPage === 1">
        Первая
      </button>
      <button class="page-btn" (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">
        Предыдущая
      </button>

      <button *ngFor="let page of getPageNumbers()" class="page-btn"
              [ngClass]="{'active': currentPage === page}"
              (click)="goToPage(page)">
        {{page}}
      </button>

      <button class="page-btn" (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages">
        Следующая
      </button>
      <button class="page-btn" (click)="goToPage(totalPages)" [disabled]="currentPage === totalPages">
        Последняя
      </button>
    </div>

    <p *ngIf="!loading && dataSource.length === 0">Заявок пока нет.</p>
  </div>
</div>